<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>群聊分析报告</title>
    <link rel="stylesheet" href="./css/template_group.css" />
</head>
<body class="${theme}-theme">

    <div class="anime-window">
        <!-- Decorations -->
        <img src="./images/decoration_tl.svg" class="deco-tl" alt="" />
        <img src="./images/decoration_br.svg" class="deco-br" alt="" />
        
        <!-- Header -->
        <div class="header-ribbon">
            <div class="header-content">
                <div class="title-main">群聊分析报告</div>
                <div class="title-sub">GROUP ANALYSIS</div>
            </div>
            <div class="header-date">
                <div class="date-val">${analysisDate}</div>
                <div class="group-val">${groupName}</div>
            </div>
        </div>

        <div class="content-area">
            
            <!-- Status Grid -->
            <div class="grid-4">
                <div class="stat-bubble">
                    <div class="stat-label">总消息</div>
                    <div class="stat-value">${totalMessages}</div>
                </div>
                <div class="stat-bubble">
                    <div class="stat-label">参与人数</div>
                    <div class="stat-value">${totalParticipants}</div>
                </div>
                <div class="stat-bubble">
                    <div class="stat-label">总字数</div>
                    <div class="stat-value">${totalChars}</div>
                </div>
                <div class="stat-bubble">
                    <div class="stat-label">活跃时段</div>
                    <div class="stat-value">${mostActivePeriod}</div>
                </div>
            </div>

            <!-- Leaderboard -->
            <div class="section-title">
                <div class="section-marker"></div>
                <h2>龙王榜</h2>
            </div>
            <div class="grid-2">
                ${userStats}
            </div>

            <!-- Titles -->
            <div class="section-title">
                <div class="section-marker"></div>
                <h2>群友称号</h2>
            </div>
            <div class="grid-2">
                ${userTitles}
            </div>

            <!-- Topics -->
            <div class="section-title">
                <div class="section-marker"></div>
                <h2>热门话题</h2>
            </div>
            <div class="dialogue-container">
                ${topics}
            </div>

            <!-- Quotes -->
            <div class="section-title">
                <div class="section-marker"></div>
                <h2>本群圣经</h2>
            </div>
            <div class="dialogue-container">
                ${goldenQuotes}
            </div>

            <!-- Chart -->
            <div class="section-title">
                <div class="section-marker"></div>
                <h2>活跃分布</h2>
            </div>
            ${activeHoursChart}

            <div class="footer-info">
                Generated by ChatLuna | Anime Theme Ver. 2.0
            </div>
        </div>
    </div>

    <script>
        const body = document.body;
        // Simple Night Mode Logic if theme is not explicitly set by backend variable or is 'auto'
        // Although the backend passes ${theme}, we might want to force update if it's empty/auto
        if (!body.className.includes('theme') || body.className.includes('auto')) {
            const hour = new Date().getHours();
            // Remove 'auto-theme' if exists
            body.classList.remove('auto-theme');
            body.classList.add(hour >= 19 || hour < 6 ? 'dark-theme' : 'light-theme');
        }
    </script>
</body>
</html>
